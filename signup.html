
<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<head>

    <title>Sign up - Little Battle</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="style/main.css" rel="stylesheet">

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="lib/jquery.scrollex.min.js"></script>
    <script src="lib/jquery.scrolly.min.js"></script>
    <script src="lib/skel.min.js"></script>
    <script src="lib/util.js"></script>
    <script src="lib/main.js"></script>
</head>

  <body>

        <!-- Page Wrapper -->
            <div id="page-wrapper">

                <!-- Header -->
                    <header id="header">
                       <h1><a href="index.html">Little Battle</a></h1>
                        <nav id="nav">
                            <ul>
                                <li class="special">
                                    <a href="#menu" class="menuToggle"><span>Menu</span></a>
                                    <div id="menu">
                                        <ul>
                                            <li><a href="index.html">Home</a></li>
                                            <li><a href="login.html">Sign in</a></li>
                                            <li><a href="signup.html">Sign up</a></li>
                                        </ul>
                                    </div>
                                </li>
                            </ul>
                        </nav>
                    </header>

                <!-- Login -->
                <article id="main">
                    <header>
                        <h2>Sign up</h2>
                    </header>
                    <section class="wrapper style5">
                            <div class="inner">
                                <section>
                                    <form>
                                        <div class="row uniform">
                                            <div class="7u">
                                                <label for="username-text">User name</label>
                                                <input type="text" id="username-text"/>
                                            </div>

                                            <div class="7u">
                                                <label for="password-text">Password</label>
                                                <input type="password" id="password-text"/>
                                            </div>

                                            <div class="7u">
                                                <label for="confirm-text">Again</label>
                                                <input type="password" id="confirm-text"/>
                                            </div>

                                            <div class="12u$">
                                                <ul class="actions">
                                                    <li id="signupBtn"><a class="button special">Sign up</a></li>
                                                </ul>
                                            </div>
                                            
                                        </div>
                                    </form>
                                </section>
                            </div>
                        </section>
                    </article>
            </div>
<script>
    var socket = io.connect();
    let get_user = ()=>{
        let id = String($("#username-text").val());
        let pswd = String($("#password-text").val());
        let cp = String($("#confirm-text").val());
        if (id.length <= 0) return{};
        return {id:id,password:pswd,cp:cp};
    };

    socket.on('dup',()=>{
        alert('User already exists!');
    });

    socket.on('accept',(id)=>{
        localStorage.curUser = id;
        window.location.href="game.html";
        
    });

    $("#signupBtn").click(()=>{
        let user = get_user();
        if (user.password !== user.cp) {
            alert('Inconsist password!');
            return;
        }
        if (user.id!=undefined)
            socket.emit('sign_up',user);
    });
</script>
</body>
</html>